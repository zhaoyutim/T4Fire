2021-11-27 18:46:40.503737: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-11-27 18:46:43.469944: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 8110 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 3080, pci bus id: 0000:1a:00.0, compute capability: 8.6
2021-11-27 18:46:43.471637: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 8110 MB memory:  -> device: 1, name: NVIDIA GeForce RTX 3080, pci bus id: 0000:1b:00.0, compute capability: 8.6
2021-11-27 18:46:43.472961: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 8110 MB memory:  -> device: 2, name: NVIDIA GeForce RTX 3080, pci bus id: 0000:1c:00.0, compute capability: 8.6
2021-11-27 18:46:43.474175: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 8110 MB memory:  -> device: 3, name: NVIDIA GeForce RTX 3080, pci bus id: 0000:1d:00.0, compute capability: 8.6
2021-11-27 18:46:43.475387: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:4 with 8110 MB memory:  -> device: 4, name: NVIDIA GeForce RTX 3080, pci bus id: 0000:1e:00.0, compute capability: 8.6
2021-11-27 18:46:43.476590: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:5 with 8110 MB memory:  -> device: 5, name: NVIDIA GeForce RTX 3080, pci bus id: 0000:3d:00.0, compute capability: 8.6
2021-11-27 18:46:49.217383: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
Epoch 1/20
   4/3827 [..............................] - ETA: 10:12 - loss: 7.0670 - accuracy: 0.8310






































































































































































































































































































3827/3827 [==============================] - 628s 161ms/step - loss: 0.0228 - accuracy: 0.9950 - val_loss: 0.0029 - val_accuracy: 0.9964
Epoch 2/20





































































































































































































































































































3827/3827 [==============================] - 614s 160ms/step - loss: 0.0065 - accuracy: 0.9958 - val_loss: 0.0026 - val_accuracy: 0.9964
Epoch 3/20





































































































































































































































































































3827/3827 [==============================] - 614s 161ms/step - loss: 0.0035 - accuracy: 0.9962 - val_loss: 0.0045 - val_accuracy: 0.9957
Epoch 4/20




































































































































































































































































































3827/3827 [==============================] - 613s 160ms/step - loss: 0.0062 - accuracy: 0.9952 - val_loss: 0.0102 - val_accuracy: 0.9940
Epoch 5/20






































































































































































































































































































3827/3827 [==============================] - 614s 161ms/step - loss: 0.0032 - accuracy: 0.9962 - val_loss: 0.0021 - val_accuracy: 0.9968
Epoch 6/20







































































































































































































































































































3827/3827 [==============================] - 614s 160ms/step - loss: 0.0022 - accuracy: 0.9968 - val_loss: 0.0020 - val_accuracy: 0.9969
Epoch 7/20





































































































































































































































































































3827/3827 [==============================] - 613s 160ms/step - loss: 0.0020 - accuracy: 0.9970 - val_loss: 0.0018 - val_accuracy: 0.9970
Epoch 8/20





































































































































































































































































































3827/3827 [==============================] - 613s 160ms/step - loss: 0.0024 - accuracy: 0.9968 - val_loss: 0.0017 - val_accuracy: 0.9971
Epoch 9/20






































































































































































































































































































3827/3827 [==============================] - 614s 160ms/step - loss: 0.0018 - accuracy: 0.9971 - val_loss: 0.0016 - val_accuracy: 0.9972
Epoch 10/20






































































































































































































































































































3827/3827 [==============================] - 614s 160ms/step - loss: 0.0020 - accuracy: 0.9970 - val_loss: 0.0017 - val_accuracy: 0.9969
Epoch 11/20





































































































































































































































































































3827/3827 [==============================] - 614s 161ms/step - loss: 0.0032 - accuracy: 0.9966 - val_loss: 0.0020 - val_accuracy: 0.9968
Epoch 12/20





































































































































































































































































































3827/3827 [==============================] - 613s 160ms/step - loss: 0.0018 - accuracy: 0.9970 - val_loss: 0.0017 - val_accuracy: 0.9971
Epoch 13/20





































































































































































































































































































3827/3827 [==============================] - 613s 160ms/step - loss: 0.0020 - accuracy: 0.9970 - val_loss: 0.0016 - val_accuracy: 0.9970
Epoch 14/20





































































































































































































































































































3827/3827 [==============================] - 614s 160ms/step - loss: 0.0019 - accuracy: 0.9970 - val_loss: 0.0017 - val_accuracy: 0.9971
Epoch 15/20





































































































































































































































































































3827/3827 [==============================] - 613s 160ms/step - loss: 0.0018 - accuracy: 0.9971 - val_loss: 0.0017 - val_accuracy: 0.9972
Epoch 16/20






































































































































































































































































































3827/3827 [==============================] - 614s 161ms/step - loss: 0.0018 - accuracy: 0.9971 - val_loss: 0.0016 - val_accuracy: 0.9972
Epoch 17/20





































































































































































































































































































3827/3827 [==============================] - 615s 161ms/step - loss: 0.0020 - accuracy: 0.9970 - val_loss: 0.0018 - val_accuracy: 0.9967
Epoch 18/20





































































































































































































































































































3827/3827 [==============================] - 612s 160ms/step - loss: 0.0020 - accuracy: 0.9970 - val_loss: 0.0017 - val_accuracy: 0.9971
Epoch 19/20






































































































































































































































































































3827/3827 [==============================] - 613s 160ms/step - loss: 0.0017 - accuracy: 0.9972 - val_loss: 0.0015 - val_accuracy: 0.9973
Epoch 20/20






































































































































































































































































































3827/3827 [==============================] - 613s 160ms/step - loss: 0.0020 - accuracy: 0.9970 - val_loss: 0.0022 - val_accuracy: 0.9962
2021-11-27 22:12:04.182179: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
/geoinfo_vol1/home/z/h/zhao2/vit-keras/vit_keras/utils.py:207: UserWarning: Did not use the following weights: {'embedding/kernel', 'head/bias', 'head/kernel', 'Transformer/posembed_input/pos_embedding', 'cls', 'embedding/bias'}
  warnings.warn(f"Did not use the following weights: {unused}", UserWarning)
/geoinfo_vol1/home/z/h/zhao2/vit-keras/vit_keras/utils.py:212: UserWarning: Only set 194 of 199 weights.
  f"Only set {target_keys_set} of {target_keys_all} weights.", UserWarning
WARNING:absl:Found untraced functions such as dense_layer_call_fn, dense_layer_call_and_return_conditional_losses, embedding_layer_call_fn, embedding_layer_call_and_return_conditional_losses, MultiHeadDotProductAttention_1_layer_call_fn while saving (showing 5 of 490). These functions will not be directly callable after loading.